- write decorator to register producer and consumer by event type
- add tests to test producers and consumers
- 
